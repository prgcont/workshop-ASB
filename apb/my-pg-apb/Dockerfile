FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG15LXBnLWFwYgpkZXNjcmlwdGlvbjogVGhpcyBpcyBhIHNhbXBs\
ZSBhcHBsaWNhdGlvbiBnZW5lcmF0ZWQgYnkgYXBiIGluaXQKYmluZGFibGU6IFRydWUKYXN5bmM6\
IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBteS1wZwpwbGFuczoKICAtIG5hbWU6\
IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIG15LXBn\
LWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICAjIGVkaXQgdGhlIHBhcmFt\
ZXRlcnMgYW5kIGFkZCB0aGUgb25lcyBiZWxvdy4KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFt\
ZTogcG9zdGdyZXNxbF9kYXRhYmFzZQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNl\
IE5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAt\
IG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFVzZXIKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAtIG5hbWU6IHBv\
c3RncmVzcWxfcGFzc3dvcmQKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29yZAogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
