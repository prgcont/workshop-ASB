* Set up Environment

Kubernetes environment with ASB (Ansible Service Broker) will be installed on your machine at the end of this exercise.

[Official Getting started docs](https://github.com/openshift/ansible-service-broker/blob/master/README.md) for Ansible Service Broker.

** Prerequisites
- [[https://kubernetes.io/docs/tasks/tools/install-minikube/][Install minikube]]
  and kubectl. Make sure ~minikube start~ and ~minikube delete~ are
  working.
- [[https://docs.helm.sh/using_helm/#install-helm][Install the helm]] binary.
- Clone the [[https://github.com/openshift/ansible-service-broker][broker's GitHub repository]]
- Installed ~kvm~, ~virtualbox~ or ~hyperv~ for minikube provisioning 
  - Either use default vm driver for minikube or config ~minikube~ to change it, e.g. for kvm2:
    - ~minikube config set vm-driver kvm2~

** Setup minikube 

#+BEGIN_SRC bash :tangle 01-setup-machine.sh :exports none :tangle-mode (identity #o755)
#!/bin/bash 

# Adjust the version to your liking. Follow installation docs
# at https://github.com/kubernetes/minikube.
minikube start --bootstrapper kubeadm --kubernetes-version v1.9.4

# Install helm and tiller. See documentation for obtaining the helm
# binary. https://docs.helm.sh/using_helm/#install-helm
helm init --wait

kubectl create clusterrolebinding tiller-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:default

# Adds the chart repository for the service catalog
helm repo add svc-cat https://svc-catalog-charts.storage.googleapis.com

# Installs the service catalog helm install svc-cat/catalog --name catalog --namespace catalog
helm install --wait svc-cat/catalog --name catalog --namespace catalog

./scripts/run_latest_k8s_build.sh
#+END_SRC
